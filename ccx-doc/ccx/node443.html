<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<html>
<head>
<title>Step 2: determining the pressure/density correction</title>
<meta content="Step 2: determining the pressure/density correction" name="description"/>
<meta content="ccx" name="keywords"/>
<meta content="document" name="resource-type"/>
<meta content="global" name="distribution"/>
<meta content="LaTeX2HTML v2017.2" name="Generator"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<link href="ccx.css" rel="STYLESHEET"/>
<link href="node444.html" rel="next"/>
<link href="node442.html" rel="previous"/>
<link href="node434.html" rel="up"/>
<link href="node444.html" rel="next"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
<script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: false
     });
  }}});
  </script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet"/>
<!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<style>
.katex { font-size: 1.1em; }
</style>
</head>
<body>
<div class="navigation"><!--Navigation Panel-->
<a href="node444.html" name="tex2html6952">
<img align="BOTTOM" alt="next" border="0" height="" src="next.svg" width="80"/></a>
<a href="node434.html" name="tex2html6948">
<img align="BOTTOM" alt="up" border="0" height="" src="up.svg" width="80"/></a>
<a href="node442.html" name="tex2html6942">
<img align="BOTTOM" alt="previous" border="0" height="" src="prev.svg" width="80"/></a>
<a href="node1.html" name="tex2html6950">
<img align="BOTTOM" alt="contents" border="0" height="" src="contents.svg" width="80"/></a>
<br/>
<b> Next:</b> <a href="node444.html" name="tex2html6953">Step 3: determining the</a>
<b> Up:</b> <a href="node434.html" name="tex2html6949">Three-Dimensional Navier-Stokes Calculations</a>
<b> Previous:</b> <a href="node442.html" name="tex2html6943">Step 1: determining</a>
 Â  <b> <a href="node1.html" name="tex2html6951">Contents</a></b>
<br/>
<br/></div>
<!--End of Navigation Panel-->
<h3><a name="SECTION0001110900000000000000">
Step 2: determining the pressure/density correction</a>
</h3>
<p>
In the second step the pressure is determined for liquids and the density for
gases. For liquids this involves the solution of a regular system of
equations, the LHS of which has been LU-decomposed. This can be performed in a
parallel way if the user has activated the multithreading option for the
linear equation solver, e.g. the option -DUSE_MT for SPOOLES in the
Makefile and specified the number of cpus by means of the environment variable
NUM_CPU_SOLVE. The RHS is obtained by adding a term based on <!-- MATH
 $\Delta
\boldsymbol{V}^*$
 -->
<span class="MATH"><b><img align="BOTTOM" alt="$ \Delta \boldsymbol {V}^*$" border="0" height="20" src="img1.png" width="39"/></b></span> to the value calculated in mafillsmv1rhs.f. This is done in
mafillprhs.f and e_c3d_prhs.f). For gases a lumped system is solved leading to the density
correction. In both cases the corrections are stored on a nodal basis in field v(1..nk,4)). Finally, for fluids the pressure boundary conditions are applied in routine
applybounp.f. For gases this has to wait till later, since the gas pressure is
not known at this point.

<p>
<br/><hr/>
</p></p></body>
</html>
