<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<html>
<head>
<title>Determining the structure of the system matrices</title>
<meta content="Determining the structure of the system matrices" name="description"/>
<meta content="ccx" name="keywords"/>
<meta content="document" name="resource-type"/>
<meta content="global" name="distribution"/>
<meta content="LaTeX2HTML v2017.2" name="Generator"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<link href="ccx.css" rel="STYLESHEET"/>
<link href="node438.html" rel="next"/>
<link href="node436.html" rel="previous"/>
<link href="node434.html" rel="up"/>
<link href="node438.html" rel="next"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
<script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: false
     });
  }}});
  </script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet"/>
<!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<style>
.katex { font-size: 1.1em; }
</style>
</head>
<body>
<div class="navigation"><!--Navigation Panel-->
<a href="node438.html" name="tex2html6880">
<img align="BOTTOM" alt="next" border="0" height="" src="next.svg" width="80"/></a>
<a href="node434.html" name="tex2html6876">
<img align="BOTTOM" alt="up" border="0" height="" src="up.svg" width="80"/></a>
<a href="node436.html" name="tex2html6870">
<img align="BOTTOM" alt="previous" border="0" height="" src="prev.svg" width="80"/></a>
<a href="node1.html" name="tex2html6878">
<img align="BOTTOM" alt="contents" border="0" height="" src="contents.svg" width="80"/></a>
<br/>
<b> Next:</b> <a href="node438.html" name="tex2html6881">Initial calculations</a>
<b> Up:</b> <a href="node434.html" name="tex2html6877">Three-Dimensional Navier-Stokes Calculations</a>
<b> Previous:</b> <a href="node436.html" name="tex2html6871">Topological information</a>
   <b> <a href="node1.html" name="tex2html6879">Contents</a></b>
<br/>
<br/></div>
<!--End of Navigation Panel-->
<h3><a name="SECTION0001110300000000000000">
Determining the structure of the system matrices</a>
</h3>
<p>
In mastructf.c the structure of the matrices of the linear equation systems is
determined. Indeed, the structure is usually sparse and therefore it is
important to know which elements are nonzero. Only these elements are
stored. This is the equivalent routine to mastruct.c for solid mechanics
applications. However, contrary to solid mechanics the single point
constraints and multiple point constraints are not taken into account while
calculating the structure of the matrix, i.e. boundary conditions do not
reduce the system of equations. So the equations are built and solved in the
assumption that no SPC's or MPC's are applied. They are taken into account at
a later stage of the calculation. This, however, does not apply to the
matrix of the pressure equations for incompressible fluids. In the latter
equations the SPC's are taken into account, but not the MPC's. The reason for
this is that the pressure equation system is the only system for which a
regular linear equation solver such as SPOOLES is used. All other systems are
diagonalized (lumped). In the absence of SPC's the solution to the pressure
equations is not unique and the corresponding matrix is singular. This cannot
be handled by a standard solver.

<p>
<div class="navigation"><hr/>
<!--Navigation Panel-->
<a href="node438.html" name="tex2html6880">
<img align="BOTTOM" alt="next" border="0" height="" src="next.svg" width="80"/></a>
<a href="node434.html" name="tex2html6876">
<img align="BOTTOM" alt="up" border="0" height="" src="up.svg" width="80"/></a>
<a href="node436.html" name="tex2html6870">
<img align="BOTTOM" alt="previous" border="0" height="" src="prev.svg" width="80"/></a>
<a href="node1.html" name="tex2html6878">
<img align="BOTTOM" alt="contents" border="0" height="" src="contents.svg" width="80"/></a>
<br/>
<b> Next:</b> <a href="node438.html" name="tex2html6881">Initial calculations</a>
<b> Up:</b> <a href="node434.html" name="tex2html6877">Three-Dimensional Navier-Stokes Calculations</a>
<b> Previous:</b> <a href="node436.html" name="tex2html6871">Topological information</a>
   <b> <a href="node1.html" name="tex2html6879">Contents</a></b> </div>
<!--End of Navigation Panel-->
</p></p></body>
</html>
