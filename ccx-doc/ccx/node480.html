<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<html>
<head>
<title>catnodes.f</title>
<meta content="catnodes.f" name="description"/>
<meta content="ccx" name="keywords"/>
<meta content="document" name="resource-type"/>
<meta content="global" name="distribution"/>
<meta content="LaTeX2HTML v2017.2" name="Generator"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<link href="ccx.css" rel="STYLESHEET"/>
<link href="node481.html" rel="next"/>
<link href="node479.html" rel="previous"/>
<link href="node463.html" rel="up"/>
<link href="node481.html" rel="next"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
<script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: false
     });
  }}});
  </script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet"/>
<!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<style>
.katex { font-size: 1.1em; }
</style>
</head>
<body>
<div class="navigation"><!--Navigation Panel-->
<a href="node481.html" name="tex2html7463">
<img align="BOTTOM" alt="next" border="0" height="" src="next.svg" width="80"/></a>
<a href="node463.html" name="tex2html7459">
<img align="BOTTOM" alt="up" border="0" height="" src="up.svg" width="80"/></a>
<a href="node479.html" name="tex2html7453">
<img align="BOTTOM" alt="previous" border="0" height="" src="prev.svg" width="80"/></a>
<a href="node1.html" name="tex2html7461">
<img align="BOTTOM" alt="contents" border="0" height="" src="contents.svg" width="80"/></a>
<br/>
<b> Next:</b> <a href="node481.html" name="tex2html7464">meshquality.f</a>
<b> Up:</b> <a href="node463.html" name="tex2html7460">Mesh refining procedure</a>
<b> Previous:</b> <a href="node479.html" name="tex2html7454">SMOOTHING THE MESH</a>
   <b> <a href="node1.html" name="tex2html7462">Contents</a></b>
<br/>
<br/></div>
<!--End of Navigation Panel-->
<h4><a name="SECTION00011125170000000000000">
catnodes.f</a>
</h4>
<p>
In the smoothing procedure the position of a node i is replaced by a weighted
average of the position of its neighbors. In principal, all nodes belonging to
the ball of node i (the ball of a node is by definition the set of element to
which this node belongs [<a href="node504.html#George">25</a>]) are neighbors. However, for some nodes
this set is further restricted. In general, a node j belonging to the ball of
node i is a neighbor of node i if:

<p>
<ul>
<li>node i is internal OR
</li>
<li>node is is external, node j is external and no sharp edges are
  attached to node i OR
</li>
<li>node i is external, node j is external and the edge connecting both is sharp.
</li>
</ul>
<p>
Thus, the neighbors of an external node must also be external, else the
weighted average “pulls” the node into the interior of the body, which is
not beneficial. For the storage of the neighbors fields iponn(*) and inn(2,*)
are used. The neighbors of node i are calculated in catnodes.f (“catalogue
nodes”) and are stored in
inn(1,iponn(i),), inn(1,inn(2,iponn(i)), inn(1,inn(2,inn(2,iponn(i))),
... until inn(2,inn(2,.....))))=0. In this context also field idimsh(*) is
used: idimsh(i) is the number of sharp edges connected to node i. Sharp edges
are by definition external edges in the unrefined mesh the normals on the adjacent faces of
which make an angle exceeding 0.0464<span class="MATH"><b><img align="BOTTOM" alt="$ ^\circ$" border="0" height="16" src="img320.png" width="11"/></b></span> (determined in checksharp.f).  

<p>
<div class="navigation"><hr/>
<!--Navigation Panel-->
<a href="node481.html" name="tex2html7463">
<img align="BOTTOM" alt="next" border="0" height="" src="next.svg" width="80"/></a>
<a href="node463.html" name="tex2html7459">
<img align="BOTTOM" alt="up" border="0" height="" src="up.svg" width="80"/></a>
<a href="node479.html" name="tex2html7453">
<img align="BOTTOM" alt="previous" border="0" height="" src="prev.svg" width="80"/></a>
<a href="node1.html" name="tex2html7461">
<img align="BOTTOM" alt="contents" border="0" height="" src="contents.svg" width="80"/></a>
<br/>
<b> Next:</b> <a href="node481.html" name="tex2html7464">meshquality.f</a>
<b> Up:</b> <a href="node463.html" name="tex2html7460">Mesh refining procedure</a>
<b> Previous:</b> <a href="node479.html" name="tex2html7454">SMOOTHING THE MESH</a>
   <b> <a href="node1.html" name="tex2html7462">Contents</a></b> </div>
<!--End of Navigation Panel-->
</p></p></p></p></body>
</html>
